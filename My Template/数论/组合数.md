# 组合数模板

```cpp
vector<long long> fac(TABLE_SIZE + 1);
vector<long long> finv(TABLE_SIZE + 1);

long long pow_mod(long long a, long long b) {
    long long res = 1;
    while (b > 0) {
        if (b & 1) {
            res = res * a % mod;
        }
        a = a * a % mod;
        b >>= 1;
    }
    return res;
}

void init() {
    fac[0] = 1;
    for (int i = 1; i <= TABLE_SIZE; ++i) {
        fac[i] = fac[i - 1] * i % mod;
    }
    finv[TABLE_SIZE] = pow_mod(fac[TABLE_SIZE], mod - 2);
    for (int i = TABLE_SIZE - 1; i >= 0; --i) {
        finv[i] = finv[i + 1] * (i + 1) % mod;
    }
}

long long C(int n, int k) {
    if (n < 0 || k < 0 || k > n) {
        return 0;
    }
    return fac[n] * finv[k] % mod * finv[n - k] % mod;
}
```