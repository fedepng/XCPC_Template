# 权值线段树模板

```cpp
#include<bits/stdc++.h>
#define int long long
#define maxn 200005

const int INF = 1e18;

using namespace std;

int arr[maxn];

struct SegmentTree {
//空间开大点
    int num[maxn << 5], sum[maxn << 5], l[maxn << 5], r[maxn << 5];
    int tot;

    void update(int& rt, int segl, int segr, int pos, int val) {
        if (!rt) rt = ++tot;
        num[rt] += val;
        sum[rt] += val * pos;
        if (segl == segr) return;
        int mid = (segl + segr) / 2;
        if (pos <= mid) update(l[rt], segl, mid, pos, val);
        else update(r[rt], mid + 1, segr, pos, val);
    }

//求满足和大于x的最少元素数量
    int query(int rt, int segl, int segr, int x) {
        if (segl == segr) return (x <= 0 ? 0 : ceil(x * 1.0 / segl));
        int mid = (segl + segr) / 2;
        if (sum[r[rt]] >= x) return query(r[rt], mid + 1, segr, x);
        else return query(l[rt], segl, mid, x - sum[r[rt]]) + num[r[rt]];
    }
} tree;
```
